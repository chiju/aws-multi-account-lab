# X Clone - Architecture Flow Diagram

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                 CLIENT LAYER                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│  Next.js 16 Frontend (React 19)                                               │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   Pages/Routes  │  │   Components    │  │   State Mgmt    │                │
│  │                 │  │                 │  │                 │                │
│  │ • / (Home)      │  │ • Auth          │  │ • Zustand       │                │
│  │ • /[username]   │  │ • Feed          │  │ • SWR           │                │
│  │ • /connect      │  │ • Profile       │  │ • Context API   │                │
│  │ • /notifications│  │ • UI Components │  │                 │                │
│  │ • /premium      │  │ • Layouts       │  │                 │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              MIDDLEWARE LAYER                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│  Next.js Middleware + NextAuth                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │  Route Protection: /connect, /[username]                               │   │
│  │  Authentication: JWT Token Validation                                  │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                API LAYER                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│  Next.js API Routes (/app/api)                                                │
│                                                                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   Auth APIs     │  │   User APIs     │  │   Post APIs     │                │
│  │                 │  │                 │  │                 │                │
│  │ • /auth/[...    │  │ • /users        │  │ • /posts        │                │
│  │   nextauth]     │  │ • /user/[id]    │  │ • /posts/[id]   │                │
│  │                 │  │ • /profile      │  │ • /posts/[id]/  │                │
│  │                 │  │ • /follow       │  │   comments      │                │
│  │                 │  │                 │  │ • /posts/[id]/  │                │
│  │                 │  │                 │  │   like          │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
│                                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                     Notification APIs                                  │   │
│  │                   • /notifications                                     │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              SERVICE LAYER                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│  Business Logic & Utilities                                                   │
│                                                                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   Auth Utils    │  │   User Utils    │  │   Validation    │                │
│  │                 │  │                 │  │                 │                │
│  │ • JWT handling  │  │ • User queries  │  │ • Zod schemas   │                │
│  │ • Password hash │  │ • Follow logic  │  │ • Input valid.  │                │
│  │ • Session mgmt  │  │ • Profile mgmt  │  │ • Error handle  │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
│                                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Custom Hooks                                    │   │
│  │  • useProfile  • useModal  • useUnfollowModal                          │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              DATA LAYER                                         │
├─────────────────────────────────────────────────────────────────────────────────┤
│  Prisma ORM + MongoDB                                                         │
│                                                                                │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │     User        │  │      Post       │  │    Comment      │                │
│  │                 │  │                 │  │                 │                │
│  │ • id            │  │ • id            │  │ • id            │                │
│  │ • name          │  │ • body          │  │ • body          │                │
│  │ • username      │  │ • userId        │  │ • userId        │                │
│  │ • email         │  │ • likedIds[]    │  │ • postId        │                │
│  │ • bio           │  │ • createdAt     │  │ • createdAt     │                │
│  │ • image         │  │ • updatedAt     │  │ • updatedAt     │                │
│  │ • coverImage    │  │                 │  │                 │                │
│  │ • followingIds[]│  │                 │  │                 │                │
│  │ • hasNotification│ │                 │  │                 │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
│                                                                                │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      Notification                                       │   │
│  │  • id  • body  • userId  • createdAt                                   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              DATABASE                                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│                              MongoDB                                           │
│                         (Cloud/Local Instance)                                │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                            EXTERNAL SERVICES                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                │
│  │   NextAuth      │  │   File Storage  │  │   Notifications │                │
│  │                 │  │                 │  │                 │                │
│  │ • OAuth         │  │ • Image uploads │  │ • Toast (React  │                │
│  │ • Credentials   │  │ • Profile pics  │  │   Hot Toast)    │                │
│  │ • JWT Sessions  │  │ • Cover images  │  │ • Real-time     │                │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                │
└─────────────────────────────────────────────────────────────────────────────────┘

DATA FLOW:
1. User interacts with React components
2. Components use SWR/Zustand for state management
3. API calls go through Next.js API routes
4. Middleware handles authentication/authorization
5. API routes use Prisma to interact with MongoDB
6. Real-time updates via SWR revalidation
7. Toast notifications for user feedback

TECH STACK:
• Frontend: Next.js 16, React 19, TypeScript, TailwindCSS
• Backend: Next.js API Routes, NextAuth.js
• Database: MongoDB with Prisma ORM
• State: Zustand, SWR, React Context
• UI: React Icons, React Hot Toast
• Auth: NextAuth.js with JWT
• Validation: Zod
• Styling: TailwindCSS v4
```

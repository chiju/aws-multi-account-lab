tempo:
  # Global tolerations for all components
  global:
    tolerations:
      - key: "node-type"
        operator: "Equal"
        value: "system"
        effect: "NoSchedule"
  tolerations:
    - key: "node-type"
      operator: "Equal"
      value: "system"
      effect: "NoSchedule"
  # StatefulSet tolerations
  statefulSet:
    tolerations:
      - key: "node-type"
        operator: "Equal"
        value: "system"
        effect: "NoSchedule"
  # Override configuration to enable metrics generator
  config: |
    multitenancy_enabled: false
    
    distributor:
      receivers:
        otlp:
          protocols:
            grpc:
              endpoint: 0.0.0.0:4317
            http:
              endpoint: 0.0.0.0:4318
    
    server:
      http_listen_port: 3200
    
    storage:
      trace:
        backend: local
        local:
          path: /var/tempo/traces
        wal:
          path: /var/tempo/wal
    
    # Enable metrics generator in main config - NO RING for single binary
    metrics_generator:
      processor:
        service_graphs:
          wait: 10s
        span_metrics:
          histogram_buckets: [0.002, 0.004, 0.008, 0.016, 0.032, 0.064, 0.128, 0.256, 0.512, 1.024, 2.048, 4.096]
          enable_target_info: true
      registry:
        collection_interval: 15s
        external_labels:
          source: tempo
          cluster: tbyte-dev
      storage:
        path: /var/tempo/wal
        remote_write:
          - url: http://monitoring-kube-prometheus-prometheus.monitoring.svc.cluster.local:9090/api/v1/write
            send_exemplars: true
    
    # Enable in overrides
    overrides:
      defaults:
        metrics_generator:
          processors: [service-graphs, span-metrics]
          collection_interval: 15s
  
  persistence:
    enabled: true
    storageClassName: gp3
    size: 10Gi
  
  service:
    type: ClusterIP
